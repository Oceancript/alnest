!function(){const t={cfg:{dataAttrAppUrl:"data-chekly-url",dataAttrCheckout:"chekly-procceded",dataAttrCustomDomain:"data-checkout-domain",dataAttrCheckoutTheme:"data-chekly-theme",defaultAppBaseUrl:"https://chekly-app.com",domainPath:"checkout"},vars:{checkoutDomain:null},cartApi:{clearCart:function(){return fetch("/cart/clear.js",{method:"POST",credentials:"same-origin"})},addToCart:function(t){return fetch("/cart/add.js",{method:"POST",credentials:"same-origin",body:"FORM"===t.nodeName?new FormData(t):t})}},helpers:{debounce:function(t,e){let o=!1;return function(){o||(o=!0,setTimeout((()=>{t.apply(this,arguments),o=!1}),e))}},isChild:(t,e)=>{let o=e.parentNode;for(;null!==o;){if(o===t)return!0;o=o.parentNode}return!1},addWrapperListener:(e,o,r)=>{e.addEventListener&&window.addEventListener(o,(o=>{(o.target===e||t.helpers.isChild(e,o.target))&&(o.stopImmediatePropagation(),o.preventDefault(),r())}),!0)},getCookie:t=>{let e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0},setCookie:(t,e)=>{let o=new Date(Date.now()+18e5).toUTCString();document.cookie=`${t}=${e}; expires=`+o+";path=/;"}},dom:{selectors:{checkoutForm:'form[action^="/cart"]:not([action^="/cart/"]), form[action="/checkout"], form[action="/a/checkout"]',checkoutButton:'[name="checkout"],[name="Checkout"],[class*="opcCheckout"],[class*="checkout-btn"],[class*="btn-checkout"],[class*="checkout-button"],[class*="button-checkout"],[class*="carthook_checkout"],[type*="submit"][class*="action_button"]:not([name*="add"]),[href*="/checkout"][class*="action_button"],[id*="checkout"],[id*="Checkout"],[id*="checkout-button"],[id*="checkout-btn"]',directCheckoutLink:'a[href^="/checkout"],[onclick*="/checkout"],a[href*="/checkout"]',addToCartForm:'form[action^="/cart/add"]',returnToField:'input[name="return_to"][value*="checkout"]',buyNowForm:'form[action^="/cart/add"][data-skip-cart="true"]',checkoutUpdateButton:'[type="submit"][name="update"]',dynamicPaymentButton:'[data-shopify="payment-button"] button,[data-shopify="payment-button"] .shopify-payment-button__button',dynamicPaymentButtonContainer:'[data-shopify="payment-button"]'},getCheckoutForms:()=>document.querySelectorAll(t.dom.selectors.checkoutForm),getCheckoutButtons:()=>document.querySelectorAll(t.dom.selectors.checkoutButton),getCheckoutLinks:()=>document.querySelectorAll(t.dom.selectors.directCheckoutLink),getBuyItNowForms:()=>{const e=[...document.querySelectorAll(t.dom.selectors.buyNowForm)];return document.querySelectorAll(t.dom.selectors.returnToField).forEach((t=>{const o=t.closest("form");o&&e.filter((t=>o.isSameNode(t))).length<=0&&e.push(o)})),e},getAddToCartForm:()=>document.querySelector(t.dom.selectors.addToCartForm),getDynamicPaymentButtons:()=>document.querySelectorAll(t.dom.selectors.dynamicPaymentButton),getUpdateCartButtons:()=>document.querySelectorAll(t.dom.selectors.checkoutUpdateButton),getDynamicPaymentButtonContainer:()=>document.querySelector(t.dom.selectors.dynamicPaymentButtonContainer)},functions:{getAppBaseUrl:()=>{const e=document.querySelector("["+t.cfg.dataAttrAppUrl+"]"),o=e.getAttribute(t.cfg.dataAttrCustomDomain),r=e.getAttribute(t.cfg.dataAttrAppUrl),n=t.cfg.defaultAppBaseUrl;return o||(r||n)},getCheckoutTheme:()=>{const e=document.querySelector("["+t.cfg.dataAttrAppUrl+"]").getAttribute(t.cfg.dataAttrCheckoutTheme);return e||!1},getOriginUrl:()=>window.location.origin,getCartToken:()=>t.helpers.getCookie("cart"),getStoreName:()=>window.Shopify&&window.Shopify.shop?window.Shopify.shop:"",getStoreActieCurrency:()=>window.Shopify.currency.active,getStoreCountry:()=>window.Shopify.country,getStoreActiveCurrencyRate:()=>window.Shopify.currency.rate,getStoreRootRoute:()=>window.Shopify.routes.root,submitBuyNowForm:e=>{let o=e.closest("form");if(o||(o=t.dom.getAddToCartForm()),o){if(!o.querySelector('[name="quantity"]')){const t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","quantity"),t.setAttribute("value","1"),o.appendChild(t)}if(!o.querySelector('input[name="return_to"]')){const t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","return_to"),t.setAttribute("value","/checkout"),o.appendChild(t)}t.cartApi.clearCart().then((()=>t.cartApi.addToCart(o))).then((()=>t.functions.processCheckout()))}},processCheckout:()=>{if(!t.vars.isCheckoutProcessing){t.vars.isCheckoutProcessing=!0;const e=t.functions.getAppBaseUrl(),o=t.functions.getCartToken(),r=t.functions.getOriginUrl().replace(/^https?:\/\//,""),n=t.functions.getStoreRootRoute(),c=t.functions.getStoreName(),a=t.functions.getStoreActiveCurrencyRate(),u=t.helpers.getCookie("_shopify_sa_p"),i=t.functions.getCheckoutTheme();let s=new URLSearchParams(window.location.search),d=s.get("utm_campaign"),m=s.get("utm_medium"),l=s.get("utm_source"),h=s.get("utm_content"),p=s.get("utm_term");const f=`${d?`&utm_campaign=${d}`:""}${m?`&utm_medium=${m}`:""}${l?`&utm_source=${l}`:""}${h?`&utm_content=${h}`:""}${p?`&utm_term=${p}`:""}`;if(e&&o&&r){let t=!1;const s=`${e}/checkout/?storeName=${r}&cartToken=${o}&curRate=${a}${i?`&theme=${i}`:""}&shopifyDomain=${c}${n.length>2?"&subFolder="+n.replace(/\//g,""):""}`;window.ga&&ga((e=>{var o=e.get("linkerParam");window.location=`${s}&${o}${u?`&${u}`:f?`${f}`:""}`,t=!0})),t||(window.location=`${s}${u?`&${u}`:f?`${f}`:""}`)}else window.location="/checkout"}},addHandlers:()=>{const e=t.dom.getCheckoutForms(),o=t.dom.getCheckoutLinks(),r=t.dom.getCheckoutButtons(),n=t.dom.getBuyItNowForms(),c=t.dom.getUpdateCartButtons();[...e].forEach((e=>{"true"!==e.getAttribute(t.cfg.dataAttrCheckout)&&(t.helpers.addWrapperListener(e,"submit",(()=>{t.functions.processCheckout()})),e.setAttribute(t.cfg.dataAttrCheckout,"true"))})),[...o,...r].forEach((e=>{"true"!==e.getAttribute(t.cfg.dataAttrCheckout)&&(t.helpers.addWrapperListener(e,"mousedown",(()=>{t.functions.processCheckout()})),t.helpers.addWrapperListener(e,"touchstart",(()=>{t.functions.processCheckout()})),t.helpers.addWrapperListener(e,"click",(()=>{t.functions.processCheckout()})),e.setAttribute(t.cfg.dataAttrCheckout,"true"))})),[...n].forEach((e=>{"true"!==e.getAttribute(t.cfg.dataAttrCheckout)&&(t.helpers.addWrapperListener(e,"submit",(()=>{t.functions.submitBuyNowForm(e)})),e.setAttribute(t.cfg.dataAttrCheckout,"true"))})),[...c].forEach((e=>{"true"!==e.getAttribute(t.cfg.dataAttrCheckout)&&(t.helpers.addWrapperListener(e,"click",(()=>{e.closest("form").submit()})),e.setAttribute(t.cfg.dataAttrCheckout,"true"))}))},addDynamicButtonHandlers:()=>{[...t.dom.getDynamicPaymentButtons()].forEach((e=>{t.helpers.addWrapperListener(e,"click",(()=>{t.functions.submitBuyNowForm(e)}))}))},reInit:()=>{t.functions.addDynamicButtonHandlers(),t.functions.addHandlers()},init:()=>{t.functions.reInit(),document.addEventListener("DOMContentLoaded",(()=>{t.functions.reInit()})),window.addEventListener("load",(()=>{t.functions.reInit();const e=t.helpers.debounce((()=>{t.functions.reInit()}),500);new MutationObserver((()=>{e()})).observe(window.document,{attributes:!0,childList:!0,subtree:!0})})),window.addEventListener("pageshow",(()=>{t.functions.reInit()}))}}};t.functions.init()}();